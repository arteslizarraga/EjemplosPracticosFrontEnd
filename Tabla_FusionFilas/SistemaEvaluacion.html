<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <style>
        /* =================================================================================================================================== */
        .tabla-info {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
        }

        .tabla-info th,
        td {
            border: 1px solid rgb(104, 103, 103);
            word-wrap: break-word;
            /* All browsers since IE 5.5+ */
            overflow-wrap: break-word;
            /* Renamed property in CSS3 draft spec */
        }

        table tr th.columna-editar-eliminar {
            width: 160px !important;
        }

        .tabla-info td {
            padding: 5px;
        }

        .tabla-info th {
            white-space: nowrap;
            /* Impide que haga un salto de linea  */
            padding: 3px;
        }

        .tabla-info thead {
            background-color: gray;
            color: white;
        }

        .sin-borde {
            border: none !important;
        }

        /* =================================================================================================================================== */
    </style>
</head>

<body>

    <br/><br/>

    <table class="tabla-info">
        <thead>
            <tr>
                <th>UA</th>
                <th>Evidencia</th>
                <th>Criterios de Evaluación</th>
                <th>Situación de Evaluación</th>
                <th>Instrumento de Evaluación</th>
                <th>% Parcial</th>
                <th>% Total</th>
            </tr>
        </thead>
        <tbody id="babu">
        </tbody>

    </table>

    <script>

        let unidadesDeAprendizaje = [
            { 
                "codigo": 987, "orden": 1, "descripcion": "Unidad AA", 
                "sistemasEvaluacion": [
                    { "codigo": 882, "evidencia": "Evidencia 1", "criterio": "Criterio de evaluación 1", "situacion": "Situación de evaluación 1", "instrumento": "Instrumento de evaluación 1", "porcentajeParcial": 25, "porcentajeTotal": 50 }, 
                    { "codigo": 883, "evidencia": "Evidencia 2", "criterio": "Criterio de evaluación 2", "situacion": "Situación de evaluación 2", "instrumento": "Instrumento de evaluación 2", "porcentajeParcial": 25, "porcentajeTotal": 50 }
                ]
            }, 
            { 
                "codigo": 988, "orden": 2, "descripcion": "Unidad AB", 
                "sistemasEvaluacion": [
                    { "codigo": 884, "evidencia": "Evidencia 3", "criterio": "Criterio de evaluación 3", "situacion": "Situación de evaluación 3", "instrumento": "Instrumento de evaluación 3", "porcentajeParcial": 30, "porcentajeTotal": 100 }, 
                    { "codigo": 885, "evidencia": "Evidencia 4", "criterio": "Criterio de evaluación 4", "situacion": "Situación de evaluación 4", "instrumento": "Instrumento de evaluación 4", "porcentajeParcial": 20, "porcentajeTotal": 100 }
                ]
            }
        ];

        const obtenerPorcentajeTotalSistemaEvaluacion = () =>
        {
            if (unidadesDeAprendizaje.length > 0 && unidadesDeAprendizaje.map(x => x.sistemasEvaluacion).length > 0) 
            {
                let suma = unidadesDeAprendizaje.map(
                    unidad => unidad.sistemasEvaluacion.map(sist => sist.porcentajeParcial).reduce((a, b) => a + b, 0)
                ).reduce((a, b) => a + b, 0); 

                return suma;
            }  

            return 0;
        }

        let babu_2 = `

        ${unidadesDeAprendizaje.map((unidad, x) => 
        { 
            let res = `
            ${unidad.sistemasEvaluacion.map((sistema, y) => 
            { 
                let res_2 = `
                <tr>
                    ${y == 0 ? ` 
                        <td rowspan="${unidad.sistemasEvaluacion.length}"> ${unidad.descripcion} </td>
                    ` : ""} 

                    <td> ${sistema.evidencia} </td>
                    <td> ${sistema.criterio} </td>
                    <td> ${sistema.situacion} </td>
                    <td> ${sistema.instrumento} </td>
                    <td> ${sistema.porcentajeParcial} % </td>

                    ${x == 0 && y == 0 ? ` 
                        <td rowspan="4">
                            ${obtenerPorcentajeTotalSistemaEvaluacion()} %
                        </td>
                    ` : ""} 
                </tr>
                `;

                return res_2;

            }).join("")} 
            `;

            return res;

        }).join("")} 

        `;

        document.querySelector("#babu").innerHTML = babu_2;

    </script>

</body>

</html>